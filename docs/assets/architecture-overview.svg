<svg width="1600" height="900" viewBox="0 0 1600 900" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="architecture overview">
  <defs>
    <linearGradient id="bg" x1="0" y1="0" x2="0.4" y2="1">
      <stop offset="0%" stop-color="#020617"/>
      <stop offset="50%" stop-color="#0a1628"/>
      <stop offset="100%" stop-color="#061b2e"/>
    </linearGradient>
    <linearGradient id="card" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#0f172a" stop-opacity="0.95"/>
      <stop offset="100%" stop-color="#0c1e35" stop-opacity="0.95"/>
    </linearGradient>
    <linearGradient id="accent" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#38bdf8"/>
      <stop offset="100%" stop-color="#2dd4bf"/>
    </linearGradient>
    <linearGradient id="purple" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#818cf8"/>
      <stop offset="100%" stop-color="#a78bfa"/>
    </linearGradient>
    <linearGradient id="orange" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#f97316"/>
      <stop offset="100%" stop-color="#fb923c"/>
    </linearGradient>
    <linearGradient id="green" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#22c55e"/>
      <stop offset="100%" stop-color="#34d399"/>
    </linearGradient>
    <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="0" dy="4" stdDeviation="8" flood-color="#000" flood-opacity="0.4"/>
    </filter>
    <filter id="glow" x="-30%" y="-30%" width="160%" height="160%">
      <feGaussianBlur stdDeviation="6" result="b"/>
      <feMerge><feMergeNode in="b"/><feMergeNode in="SourceGraphic"/></feMerge>
    </filter>
    <marker id="arrow-cyan" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto-start-reverse">
      <path d="M0,0 L8,4 L0,8 z" fill="#22d3ee" opacity="0.8"/>
    </marker>
    <marker id="arrow-purple" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto-start-reverse">
      <path d="M0,0 L8,4 L0,8 z" fill="#818cf8" opacity="0.8"/>
    </marker>
    <marker id="arrow-green" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto-start-reverse">
      <path d="M0,0 L8,4 L0,8 z" fill="#34d399" opacity="0.8"/>
    </marker>
    <marker id="arrow-orange" markerWidth="8" markerHeight="8" refX="7" refY="4" orient="auto-start-reverse">
      <path d="M0,0 L8,4 L0,8 z" fill="#fb923c" opacity="0.8"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1600" height="900" fill="url(#bg)"/>

  <!-- Subtle grid -->
  <g opacity="0.04" stroke="#67e8f9" stroke-width="1">
    <line x1="0" y1="100" x2="1600" y2="100"/>
    <line x1="0" y1="200" x2="1600" y2="200"/>
    <line x1="0" y1="300" x2="1600" y2="300"/>
    <line x1="0" y1="400" x2="1600" y2="400"/>
    <line x1="0" y1="500" x2="1600" y2="500"/>
    <line x1="0" y1="600" x2="1600" y2="600"/>
    <line x1="0" y1="700" x2="1600" y2="700"/>
    <line x1="0" y1="800" x2="1600" y2="800"/>
    <line x1="200" y1="0" x2="200" y2="900"/>
    <line x1="400" y1="0" x2="400" y2="900"/>
    <line x1="600" y1="0" x2="600" y2="900"/>
    <line x1="800" y1="0" x2="800" y2="900"/>
    <line x1="1000" y1="0" x2="1000" y2="900"/>
    <line x1="1200" y1="0" x2="1200" y2="900"/>
    <line x1="1400" y1="0" x2="1400" y2="900"/>
  </g>

  <!-- Title -->
  <text x="800" y="52" text-anchor="middle" fill="#e2e8f0" font-family="'Segoe UI', Arial, sans-serif" font-size="32" font-weight="700" letter-spacing="1">SYSTEM ARCHITECTURE</text>
  <line x1="600" y1="65" x2="1000" y2="65" stroke="url(#accent)" stroke-width="2" opacity="0.6"/>

  <!-- ═══════ TIER 1: Entry Points ═══════ -->
  <text x="80" y="112" fill="#94a3b8" font-family="Consolas, monospace" font-size="14" font-weight="700" letter-spacing="2">ENTRY POINTS</text>

  <!-- CLI -->
  <g filter="url(#shadow)">
    <rect x="340" y="90" width="200" height="60" rx="12" fill="url(#card)" stroke="#818cf8" stroke-opacity="0.5" stroke-width="1.2"/>
    <text x="365" y="126" fill="#c4b5fd" font-family="Consolas, monospace" font-size="16" font-weight="700">CLI</text>
    <text x="400" y="126" fill="#94a3b8" font-family="Consolas, monospace" font-size="13">awe_agentcheck</text>
  </g>

  <!-- REST API -->
  <g filter="url(#shadow)">
    <rect x="600" y="90" width="200" height="60" rx="12" fill="url(#card)" stroke="#38bdf8" stroke-opacity="0.5" stroke-width="1.2"/>
    <text x="625" y="126" fill="#7dd3fc" font-family="Consolas, monospace" font-size="16" font-weight="700">REST API</text>
    <text x="720" y="126" fill="#94a3b8" font-family="Consolas, monospace" font-size="13">:8000</text>
  </g>

  <!-- Web UI -->
  <g filter="url(#shadow)">
    <rect x="860" y="90" width="200" height="60" rx="12" fill="url(#card)" stroke="#2dd4bf" stroke-opacity="0.5" stroke-width="1.2"/>
    <text x="885" y="126" fill="#5eead4" font-family="Consolas, monospace" font-size="16" font-weight="700">Web Monitor</text>
  </g>

  <!-- SSE Events -->
  <g filter="url(#shadow)">
    <rect x="1120" y="90" width="200" height="60" rx="12" fill="url(#card)" stroke="#f97316" stroke-opacity="0.5" stroke-width="1.2"/>
    <text x="1145" y="126" fill="#fdba74" font-family="Consolas, monospace" font-size="16" font-weight="700">SSE Events</text>
  </g>

  <!-- Arrows from entry points to control plane -->
  <g stroke="#67e8f9" stroke-width="2" fill="none" opacity="0.5">
    <line x1="440" y1="150" x2="440" y2="210" marker-end="url(#arrow-cyan)"/>
    <line x1="700" y1="150" x2="700" y2="210" marker-end="url(#arrow-cyan)"/>
    <line x1="960" y1="150" x2="960" y2="210" marker-end="url(#arrow-cyan)"/>
    <line x1="1220" y1="150" x2="1220" y2="210" marker-end="url(#arrow-cyan)"/>
  </g>

  <!-- ═══════ TIER 2: FastAPI Control Plane ═══════ -->
  <g filter="url(#shadow)">
    <rect x="300" y="210" width="1060" height="80" rx="16" fill="url(#card)" stroke="url(#accent)" stroke-opacity="0.5" stroke-width="1.5"/>
    <text x="340" y="258" fill="url(#accent)" font-family="'Segoe UI', Arial, sans-serif" font-size="24" font-weight="700">FastAPI Control Plane</text>
    <g font-family="Consolas, monospace" font-size="14" fill="#94a3b8">
      <text x="620" y="258">api.py</text>
      <text x="700" y="258">·</text>
      <text x="720" y="258">service.py</text>
      <text x="830" y="258">·</text>
      <text x="850" y="258">config.py</text>
      <text x="960" y="258">·</text>
      <text x="980" y="258">repository.py</text>
      <text x="1120" y="258">·</text>
      <text x="1140" y="258">db.py</text>
    </g>
  </g>

  <!-- Arrow down from control plane -->
  <line x1="830" y1="290" x2="830" y2="340" stroke="#67e8f9" stroke-width="2" opacity="0.5" marker-end="url(#arrow-cyan)"/>

  <!-- ═══════ TIER 3: Core Engine ═══════ -->
  <text x="80" y="370" fill="#94a3b8" font-family="Consolas, monospace" font-size="14" font-weight="700" letter-spacing="2">CORE ENGINE</text>

  <!-- Workflow Engine - center -->
  <g filter="url(#shadow)">
    <rect x="340" y="340" width="980" height="120" rx="16" fill="url(#card)" stroke="#34d399" stroke-opacity="0.45" stroke-width="1.5"/>
    <text x="380" y="380" fill="url(#green)" font-family="'Segoe UI', Arial, sans-serif" font-size="20" font-weight="700">Workflow Engine</text>
    <text x="570" y="380" fill="#64748b" font-family="Consolas, monospace" font-size="14">workflow.py</text>

    <!-- Workflow steps as pipeline -->
    <g transform="translate(380, 400)">
      <rect x="0" y="0" rx="8" ry="8" width="130" height="36" fill="#0a1f35" stroke="#3b82f6" stroke-opacity="0.4"/>
      <text x="65" y="24" text-anchor="middle" fill="#93c5fd" font-family="Consolas, monospace" font-size="13">Discussion</text>

      <path d="M138,18 L158,18" stroke="#4ade80" stroke-width="2" marker-end="url(#arrow-green)" opacity="0.6"/>

      <rect x="166" y="0" rx="8" ry="8" width="160" height="36" fill="#0a1f35" stroke="#3b82f6" stroke-opacity="0.4"/>
      <text x="246" y="24" text-anchor="middle" fill="#93c5fd" font-family="Consolas, monospace" font-size="13">Implementation</text>

      <path d="M334,18 L354,18" stroke="#4ade80" stroke-width="2" marker-end="url(#arrow-green)" opacity="0.6"/>

      <rect x="362" y="0" rx="8" ry="8" width="110" height="36" fill="#0a1f35" stroke="#3b82f6" stroke-opacity="0.4"/>
      <text x="417" y="24" text-anchor="middle" fill="#93c5fd" font-family="Consolas, monospace" font-size="13">Review</text>

      <path d="M480,18 L500,18" stroke="#4ade80" stroke-width="2" marker-end="url(#arrow-green)" opacity="0.6"/>

      <rect x="508" y="0" rx="8" ry="8" width="140" height="36" fill="#0a1f35" stroke="#3b82f6" stroke-opacity="0.4"/>
      <text x="578" y="24" text-anchor="middle" fill="#93c5fd" font-family="Consolas, monospace" font-size="13">Verification</text>

      <path d="M656,18 L676,18" stroke="#4ade80" stroke-width="2" marker-end="url(#arrow-green)" opacity="0.6"/>

      <rect x="684" y="0" rx="8" ry="8" width="120" height="36" fill="#0a1f35" stroke="#22c55e" stroke-opacity="0.5"/>
      <text x="744" y="24" text-anchor="middle" fill="#4ade80" font-family="Consolas, monospace" font-size="13" font-weight="700">Gate</text>
    </g>
  </g>

  <!-- ═══════ TIER 4: Supporting Modules ═══════ -->
  <text x="80" y="510" fill="#94a3b8" font-family="Consolas, monospace" font-size="14" font-weight="700" letter-spacing="2">MODULES</text>

  <!-- Provider Adapters - left -->
  <g filter="url(#shadow)">
    <rect x="100" y="520" width="300" height="160" rx="14" fill="url(#card)" stroke="#818cf8" stroke-opacity="0.45" stroke-width="1.2"/>
    <text x="130" y="556" fill="url(#purple)" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="700">Provider Adapters</text>
    <text x="310" y="556" fill="#64748b" font-family="Consolas, monospace" font-size="13">adapters.py</text>

    <rect x="120" y="574" width="120" height="34" rx="8" fill="#0a1f35" stroke="#818cf8" stroke-opacity="0.35"/>
    <text x="180" y="596" text-anchor="middle" fill="#c4b5fd" font-family="Consolas, monospace" font-size="14">Claude CLI</text>

    <rect x="260" y="574" width="120" height="34" rx="8" fill="#0a1f35" stroke="#818cf8" stroke-opacity="0.35"/>
    <text x="320" y="596" text-anchor="middle" fill="#c4b5fd" font-family="Consolas, monospace" font-size="14">Codex CLI</text>

    <rect x="120" y="624" width="260" height="34" rx="8" fill="#0a1f35" stroke="#818cf8" stroke-opacity="0.25"/>
    <text x="250" y="646" text-anchor="middle" fill="#94a3b8" font-family="Consolas, monospace" font-size="13">Pluggable (future)</text>
  </g>

  <!-- Author Gate + Fusion - center -->
  <g filter="url(#shadow)">
    <rect x="440" y="520" width="340" height="160" rx="14" fill="url(#card)" stroke="#f97316" stroke-opacity="0.45" stroke-width="1.2"/>
    <text x="470" y="556" fill="url(#orange)" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="700">Policy &amp; Fusion</text>

    <rect x="460" y="574" width="140" height="34" rx="8" fill="#0a1f35" stroke="#f97316" stroke-opacity="0.35"/>
    <text x="530" y="596" text-anchor="middle" fill="#fdba74" font-family="Consolas, monospace" font-size="14">Author Gate</text>

    <rect x="620" y="574" width="140" height="34" rx="8" fill="#0a1f35" stroke="#f97316" stroke-opacity="0.35"/>
    <text x="690" y="596" text-anchor="middle" fill="#fdba74" font-family="Consolas, monospace" font-size="14">Auto Fusion</text>

    <g font-family="Consolas, monospace" font-size="12" fill="#64748b">
      <text x="470" y="646">gate.py</text>
      <text x="540" y="646">·</text>
      <text x="560" y="646">fusion.py</text>
      <text x="650" y="646">·</text>
      <text x="670" y="646">automation.py</text>
    </g>
  </g>

  <!-- Sandbox Manager - right of center -->
  <g filter="url(#shadow)">
    <rect x="820" y="520" width="280" height="160" rx="14" fill="url(#card)" stroke="#22d3ee" stroke-opacity="0.45" stroke-width="1.2"/>
    <text x="850" y="556" fill="#67e8f9" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="700">Sandbox Manager</text>

    <rect x="840" y="574" width="240" height="34" rx="8" fill="#0a1f35" stroke="#22d3ee" stroke-opacity="0.35"/>
    <text x="960" y="596" text-anchor="middle" fill="#67e8f9" font-family="Consolas, monospace" font-size="14">Per-Task Isolation</text>

    <rect x="840" y="624" width="240" height="34" rx="8" fill="#0a1f35" stroke="#22d3ee" stroke-opacity="0.25"/>
    <text x="960" y="646" text-anchor="middle" fill="#94a3b8" font-family="Consolas, monospace" font-size="13">Auto-clean on pass</text>
  </g>

  <!-- Participants - far right -->
  <g filter="url(#shadow)">
    <rect x="1140" y="520" width="360" height="160" rx="14" fill="url(#card)" stroke="#2dd4bf" stroke-opacity="0.45" stroke-width="1.2"/>
    <text x="1170" y="556" fill="#5eead4" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="700">Participant Model</text>
    <text x="1380" y="556" fill="#64748b" font-family="Consolas, monospace" font-size="13">participants.py</text>

    <rect x="1160" y="574" width="160" height="34" rx="8" fill="#0a1f35" stroke="#2dd4bf" stroke-opacity="0.35"/>
    <text x="1240" y="596" text-anchor="middle" fill="#5eead4" font-family="Consolas, monospace" font-size="14">provider#alias</text>

    <rect x="1340" y="574" width="140" height="34" rx="8" fill="#0a1f35" stroke="#2dd4bf" stroke-opacity="0.35"/>
    <text x="1410" y="596" text-anchor="middle" fill="#5eead4" font-family="Consolas, monospace" font-size="14">Multi-session</text>

    <rect x="1160" y="624" width="320" height="34" rx="8" fill="#0a1f35" stroke="#2dd4bf" stroke-opacity="0.25"/>
    <text x="1320" y="646" text-anchor="middle" fill="#94a3b8" font-family="Consolas, monospace" font-size="13">Role avatars · Pixel art generation</text>
  </g>

  <!-- Connecting arrows: Control Plane → Modules -->
  <g stroke="#67e8f9" stroke-width="1.5" fill="none" opacity="0.35" stroke-dasharray="6,4">
    <line x1="500" y1="460" x2="250" y2="520" marker-end="url(#arrow-cyan)"/>
    <line x1="700" y1="460" x2="610" y2="520" marker-end="url(#arrow-cyan)"/>
    <line x1="960" y1="460" x2="960" y2="520" marker-end="url(#arrow-cyan)"/>
    <line x1="1100" y1="460" x2="1320" y2="520" marker-end="url(#arrow-cyan)"/>
  </g>

  <!-- ═══════ TIER 5: Storage & Observability ═══════ -->
  <text x="80" y="738" fill="#94a3b8" font-family="Consolas, monospace" font-size="14" font-weight="700" letter-spacing="2">INFRASTRUCTURE</text>

  <!-- PostgreSQL / In-Memory -->
  <g filter="url(#shadow)">
    <rect x="100" y="750" width="260" height="100" rx="14" fill="url(#card)" stroke="#3b82f6" stroke-opacity="0.45" stroke-width="1.2"/>
    <text x="130" y="790" fill="#93c5fd" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="700">Database</text>
    <text x="130" y="822" fill="#64748b" font-family="Consolas, monospace" font-size="13">PostgreSQL · SQLAlchemy</text>
    <text x="130" y="840" fill="#475569" font-family="Consolas, monospace" font-size="12">In-memory fallback</text>
  </g>

  <!-- Artifact Storage -->
  <g filter="url(#shadow)">
    <rect x="400" y="750" width="260" height="100" rx="14" fill="url(#card)" stroke="#f59e0b" stroke-opacity="0.45" stroke-width="1.2"/>
    <text x="430" y="790" fill="#fcd34d" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="700">Artifacts</text>
    <text x="430" y="822" fill="#64748b" font-family="Consolas, monospace" font-size="13">.agents/threads/</text>
    <text x="430" y="840" fill="#475569" font-family="Consolas, monospace" font-size="12">Events · Reports · Summaries</text>
  </g>

  <!-- Observability Stack -->
  <g filter="url(#shadow)">
    <rect x="700" y="750" width="800" height="100" rx="14" fill="url(#card)" stroke="#22c55e" stroke-opacity="0.45" stroke-width="1.5"/>
    <text x="740" y="790" fill="url(#green)" font-family="'Segoe UI', Arial, sans-serif" font-size="18" font-weight="700">Observability Stack</text>
    <text x="940" y="790" fill="#64748b" font-family="Consolas, monospace" font-size="13">observability.py</text>

    <!-- OTel badges -->
    <g transform="translate(740, 806)">
      <rect x="0" y="0" rx="6" ry="6" width="140" height="30" fill="#0a1f35" stroke="#22c55e" stroke-opacity="0.4"/>
      <text x="70" y="20" text-anchor="middle" fill="#4ade80" font-family="Consolas, monospace" font-size="13">OpenTelemetry</text>

      <rect x="160" y="0" rx="6" ry="6" width="130" height="30" fill="#0a1f35" stroke="#22c55e" stroke-opacity="0.4"/>
      <text x="225" y="20" text-anchor="middle" fill="#4ade80" font-family="Consolas, monospace" font-size="13">Prometheus</text>

      <rect x="310" y="0" rx="6" ry="6" width="80" height="30" fill="#0a1f35" stroke="#22c55e" stroke-opacity="0.4"/>
      <text x="350" y="20" text-anchor="middle" fill="#4ade80" font-family="Consolas, monospace" font-size="13">Loki</text>

      <rect x="410" y="0" rx="6" ry="6" width="90" height="30" fill="#0a1f35" stroke="#22c55e" stroke-opacity="0.4"/>
      <text x="455" y="20" text-anchor="middle" fill="#4ade80" font-family="Consolas, monospace" font-size="13">Tempo</text>

      <rect x="520" y="0" rx="6" ry="6" width="110" height="30" fill="#0a1f35" stroke="#22c55e" stroke-opacity="0.4"/>
      <text x="575" y="20" text-anchor="middle" fill="#4ade80" font-family="Consolas, monospace" font-size="13">Grafana</text>
    </g>
  </g>

  <!-- Connecting arrows: Modules → Infrastructure -->
  <g stroke="#475569" stroke-width="1.5" fill="none" opacity="0.3" stroke-dasharray="6,4">
    <line x1="250" y1="680" x2="230" y2="750" marker-end="url(#arrow-cyan)"/>
    <line x1="610" y1="680" x2="530" y2="750" marker-end="url(#arrow-cyan)"/>
    <line x1="960" y1="680" x2="1100" y2="750" marker-end="url(#arrow-cyan)"/>
    <line x1="1320" y1="680" x2="1300" y2="750" marker-end="url(#arrow-cyan)"/>
  </g>
</svg>
